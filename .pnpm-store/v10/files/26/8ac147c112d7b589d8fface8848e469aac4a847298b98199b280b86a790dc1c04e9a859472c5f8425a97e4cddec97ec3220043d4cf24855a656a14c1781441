this.tapps=this.tapps||{};this.tapps.bridge=function(p){"use strict";var k;function we(t){return{lang:(t==null?void 0:t.lang)??(k==null?void 0:k.lang),message:t==null?void 0:t.message,abortEarly:(t==null?void 0:t.abortEarly)??(k==null?void 0:k.abortEarly),abortPipeEarly:(t==null?void 0:t.abortPipeEarly)??(k==null?void 0:k.abortPipeEarly)}}var z;function $t(t){return z==null?void 0:z.get(t)}var G;function Pt(t){return G==null?void 0:G.get(t)}var F;function St(t,e){var n;return(n=F==null?void 0:F.get(t))==null?void 0:n.get(e)}function jt(t){var n,r;const e=typeof t;return e==="string"?`"${t}"`:e==="number"||e==="bigint"||e==="boolean"?`${t}`:e==="object"||e==="function"?(t&&((r=(n=Object.getPrototypeOf(t))==null?void 0:n.constructor)==null?void 0:r.name))??"null":e}function T(t,e,n,r,s){const i=s&&"input"in s?s.input:n.value,a=(s==null?void 0:s.expected)??t.expects??null,u=(s==null?void 0:s.received)??jt(i),o={kind:t.kind,type:t.type,input:i,expected:a,received:u,message:`Invalid ${e}: ${a?`Expected ${a} but r`:"R"}eceived ${u}`,requirement:t.requirement,path:s==null?void 0:s.path,issues:s==null?void 0:s.issues,lang:r.lang,abortEarly:r.abortEarly,abortPipeEarly:r.abortPipeEarly},c=t.kind==="schema",l=(s==null?void 0:s.message)??t.message??St(t.reference,o.lang)??(c?Pt(o.lang):null)??r.message??$t(o.lang);l!==void 0&&(o.message=typeof l=="function"?l(o):l),c&&(n.typed=!1),n.issues?n.issues.push(o):n.issues=[o]}function E(t){return{version:1,vendor:"valibot",validate(e){return t["~run"]({value:e},we())}}}function At(t,e){return Object.hasOwn(t,e)&&e!=="__proto__"&&e!=="prototype"&&e!=="constructor"}var Mt=class extends Error{constructor(t){super(t[0].message),this.name="ValiError",this.issues=t}};function Tt(t,e,n){return typeof t.fallback=="function"?t.fallback(e,n):t.fallback}function B(t,e,n){return typeof t.default=="function"?t.default(e,n):t.default}function D(t,e){return!t["~run"]({value:e},{abortEarly:!0}).issues}function Ee(){return{kind:"schema",type:"any",reference:Ee,expects:"any",async:!1,get"~standard"(){return E(this)},"~run"(t){return t.typed=!0,t}}}function K(t){return{kind:"schema",type:"boolean",reference:K,expects:"boolean",async:!1,message:t,get"~standard"(){return E(this)},"~run"(e,n){return typeof e.value=="boolean"?e.typed=!0:T(this,"type",e,n),e}}}function Y(t){return{kind:"schema",type:"function",reference:Y,expects:"Function",async:!1,message:t,get"~standard"(){return E(this)},"~run"(e,n){return typeof e.value=="function"?e.typed=!0:T(this,"type",e,n),e}}}function w(t,e){return{kind:"schema",type:"loose_object",reference:w,expects:"Object",async:!1,entries:t,message:e,get"~standard"(){return E(this)},"~run"(n,r){var i;const s=n.value;if(s&&typeof s=="object"){n.typed=!0,n.value={};for(const a in this.entries){const u=this.entries[a];if(a in s||(u.type==="exact_optional"||u.type==="optional"||u.type==="nullish")&&u.default!==void 0){const o=a in s?s[a]:B(u),c=u["~run"]({value:o},r);if(c.issues){const l={type:"object",origin:"value",input:s,key:a,value:o};for(const f of c.issues)f.path?f.path.unshift(l):f.path=[l],(i=n.issues)==null||i.push(f);if(n.issues||(n.issues=c.issues),r.abortEarly){n.typed=!1;break}}c.typed||(n.typed=!1),n.value[a]=c.value}else if(u.fallback!==void 0)n.value[a]=Tt(u);else if(u.type!=="exact_optional"&&u.type!=="optional"&&u.type!=="nullish"&&(T(this,"key",n,r,{input:void 0,expected:`"${a}"`,path:[{type:"object",origin:"key",input:s,key:a,value:s[a]}]}),r.abortEarly))break}if(!n.issues||!r.abortEarly)for(const a in s)At(s,a)&&!(a in this.entries)&&(n.value[a]=s[a])}else T(this,"type",n,r);return n}}}function U(t,e){return{kind:"schema",type:"nullish",reference:U,expects:`(${t.expects} | null | undefined)`,async:!1,wrapped:t,default:e,get"~standard"(){return E(this)},"~run"(n,r){return(n.value===null||n.value===void 0)&&(this.default!==void 0&&(n.value=B(this,n,r)),n.value===null||n.value===void 0)?(n.typed=!0,n):this.wrapped["~run"](n,r)}}}function H(t){return{kind:"schema",type:"number",reference:H,expects:"number",async:!1,message:t,get"~standard"(){return E(this)},"~run"(e,n){return typeof e.value=="number"&&!isNaN(e.value)?e.typed=!0:T(this,"type",e,n),e}}}function Q(t,e){return{kind:"schema",type:"optional",reference:Q,expects:`(${t.expects} | undefined)`,async:!1,wrapped:t,default:e,get"~standard"(){return E(this)},"~run"(n,r){return n.value===void 0&&(this.default!==void 0&&(n.value=B(this,n,r)),n.value===void 0)?(n.typed=!0,n):this.wrapped["~run"](n,r)}}}function P(t){return{kind:"schema",type:"string",reference:P,expects:"string",async:!1,message:t,get"~standard"(){return E(this)},"~run"(e,n){return typeof e.value=="string"?e.typed=!0:T(this,"type",e,n),e}}}function ke(){return{kind:"schema",type:"unknown",reference:ke,expects:"unknown",async:!1,get"~standard"(){return E(this)},"~run"(t){return t.typed=!0,t}}}function Z(t,e,n){const r=t["~run"]({value:e},we(n));if(r.issues)throw new Mt(r.issues);return r.value}function $e(...t){return{...t[0],pipe:t,get"~standard"(){return E(this)},"~run"(e,n){for(const r of t)if(r.kind!=="metadata"){if(e.issues&&(r.kind==="schema"||r.kind==="transformation")){e.typed=!1;break}(!e.issues||!n.abortEarly&&!n.abortPipeEarly)&&(e=r["~run"](e,n))}return e}}}function X(t){return D(w({TelegramWebviewProxy:w({postEvent:Y()})}),t)}function V(){try{return window.self!==window.top}catch{return!0}}var qt=Object.defineProperty,It=(t,e,n)=>e in t?qt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ee=(t,e,n)=>It(t,typeof e!="symbol"?e+"":e,n),Lt=Object.defineProperty,Rt=(t,e,n)=>e in t?Lt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,xt=(t,e,n)=>Rt(t,e+"",n);function Ut(t,e){return n=>n instanceof t&&n.type===e}function Pe(t,e){e||(e=[]);const n=Symbol(t);class r extends Error{constructor(...i){const a=typeof e=="function"?e(...i):typeof e=="string"?[e]:e||[];super(...a),xt(this,"type",n),this.name=t}}return Object.defineProperty(r,"name",{value:t}),[r,Ut(r,n)]}const[Se,Wt]=Pe("CancelledError","Promise was canceled"),[je,Dt]=Pe("TimeoutError",(t,e)=>[`Timeout reached: ${t}ms`,{cause:e}]),Ae=Symbol("Resolved");function Me(t){return Array.isArray(t)&&t[0]===Ae}function Ot(t){return[Ae,t]}function Te(t,e){return t.reject=e.reject,t.abort=e.abort,t}class M extends Promise{constructor(e,n){let r,s;super((i,a)=>{let u,o;typeof e=="function"?(u=e,o=n):o=e;const c=[],l=y=>(...x)=>{const J=y(...x);return c.forEach(Rn=>Rn()),J},f=new AbortController,{signal:h}=f;s=y=>{!h.aborted&&f.abort(y)};const _=()=>h.reason,A=y=>{const x=()=>{y(_())};h.addEventListener("abort",x,!0);const J=()=>{h.removeEventListener("abort",x,!0)};return c.push(J),J},Ln=l(y=>{i(y),s(Ot(y))});r=l(y=>{a(y),s(y)}),o||(o={});const{abortSignal:R,rejectOnAbort:vt=!0}=o;if(R)if(R.aborted){const{reason:y}=R;if(vt)return r(y);s(y)}else{const y=()=>{s(R.reason)};R.addEventListener("abort",y),c.push(()=>{R.removeEventListener("abort",y)})}vt&&A(a);const{timeout:ge}=o;if(ge){const y=setTimeout(()=>{s(new je(ge))},ge);c.push(()=>{clearTimeout(y)})}const wt=()=>h.aborted,Et=()=>Me(_()),kt=()=>{const y=_();return Me(y)?y[1]:void 0};try{const y=u&&u(Ln,r,{abortReason:_,abortSignal:h,isAborted:wt,isResolved:Et,onAborted:A,onResolved:x=>A(()=>{Et()&&x(kt())}),resolved:kt,throwIfAborted(){if(wt())throw _()}});y instanceof Promise&&y.catch(r)}catch(y){r(y)}}),ee(this,"abort"),ee(this,"reject"),this.abort=s,this.reject=r}static fn(e,n){return new M(async(r,s,i)=>{try{r(await e(i))}catch(a){s(a)}},n)}static resolve(e){return this.fn(()=>e)}static reject(e){return new M((n,r)=>{r(e)})}cancel(){this.abort(new Se)}catch(e){return this.then(void 0,e)}finally(e){return Te(super.finally(e),this)}then(e,n){return Te(super.then(e,n),this)}}function qe(t,e){return t.resolve=e.resolve,t}let Ct=class ve extends M{constructor(e,n){let r,s;typeof e=="function"?(r=e,s=n):s=e;let i;super((a,u,o)=>{i=a,r&&r(a,u,o)},s),ee(this,"resolve"),this.resolve=i}static fn(e,n){return new ve((r,s,i)=>{try{Promise.resolve(e(i)).then(r,s)}catch(a){s(a)}},n)}static resolve(e){return this.fn(()=>e)}static reject(e){return new ve((n,r)=>{r(e)})}catch(e){return this.then(void 0,e)}finally(e){return qe(super.finally(e),this)}then(e,n){return qe(super.then(e,n),this)}};function Nt(t){return t.replace(/_[a-z]/g,e=>e[1].toUpperCase())}function Jt(t){return Object.entries(t).reduce((e,[n,r])=>(e[Nt(n)]=r,e),{})}function te(t){const e=Jt(t);for(const n in e){const r=e[n];r&&typeof r=="object"&&!(r instanceof Date)&&(e[n]=Array.isArray(r)?r.map(te):te(r))}return e}function Ie(t){return`tapps/${t}`}function Le(t,e){sessionStorage.setItem(Ie(t),JSON.stringify(e))}function zt(t){const e=sessionStorage.getItem(Ie(t));try{return e?JSON.parse(e):void 0}catch{}}function Gt(...t){const e=t.flat(1);return[e.push.bind(e),()=>{e.forEach(n=>{n()})}]}function Re(t,e){e||(e={});const{textColor:n,bgColor:r,shouldLog:s}=e,i=s===void 0?!0:s,a=typeof i=="boolean"?()=>i:i,u=(o,c,...l)=>{if(c||a()){const f="font-weight:bold;padding:0 5px;border-radius:100px",[h,_,A]={log:["#0089c3","white","INFO"],error:["#ff0000F0","white","ERR"],warn:["#D38E15","white","WARN"]}[o];console[o](`%c${A} ${Intl.DateTimeFormat("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3,timeZone:"UTC"}).format(new Date)}%c %c${t}`,`${f};background-color:${h};color:${_}`,"",`${f};${n?`color:${n};`:""}${r?`background-color:${r}`:""}`,...l)}};return[["log","forceLog"],["warn","forceWarn"],["error","forceError"]].reduce((o,[c,l])=>(o[c]=u.bind(void 0,c,!1),o[l]=u.bind(void 0,c,!0),o),{})}function xe(t){return{lang:(t==null?void 0:t.lang)??void 0,message:t==null?void 0:t.message,abortEarly:(t==null?void 0:t.abortEarly)??void 0,abortPipeEarly:(t==null?void 0:t.abortPipeEarly)??void 0}}function xn(t){}function Un(t){}function Ft(t,e){var n;return(n=void 0)==null?void 0:n.get(e)}function Bt(t){var e,n;const r=typeof t;return r==="string"?`"${t}"`:r==="number"||r==="bigint"||r==="boolean"?`${t}`:r==="object"||r==="function"?(t&&((n=(e=Object.getPrototypeOf(t))==null?void 0:e.constructor)==null?void 0:n.name))??"null":r}function g(t,e,n,r,s){const i=s&&"input"in s?s.input:n.value,a=(s==null?void 0:s.expected)??t.expects??null,u=(s==null?void 0:s.received)??Bt(i),o={kind:t.kind,type:t.type,input:i,expected:a,received:u,message:`Invalid ${e}: ${a?`Expected ${a} but r`:"R"}eceived ${u}`,requirement:t.requirement,path:s==null?void 0:s.path,issues:s==null?void 0:s.issues,lang:r.lang,abortEarly:r.abortEarly,abortPipeEarly:r.abortPipeEarly},c=t.kind==="schema",l=(s==null?void 0:s.message)??t.message??Ft(t.reference,o.lang)??(c?(o.lang,void 0):null)??r.message??(o.lang,void 0);l&&(o.message=typeof l=="function"?l(o):l),c&&(n.typed=!1),n.issues?n.issues.push(o):n.issues=[o]}function v(t){return{version:1,vendor:"valibot",validate(e){return t["~run"]({value:e},xe())}}}function Ue(t,e){return Object.hasOwn(t,e)&&e!=="__proto__"&&e!=="prototype"&&e!=="constructor"}function Kt(t,e){const n=[...new Set(t)];return n.length>1?`(${n.join(` ${e} `)})`:n[0]??"never"}var Yt=class extends Error{constructor(t){super(t[0].message),this.name="ValiError",this.issues=t}};function We(t,e){return{kind:"validation",type:"check",reference:We,async:!1,expects:null,requirement:t,message:e,"~run"(n,r){return n.typed&&!this.requirement(n.value)&&g(this,"input",n,r),n}}}function De(t){return{kind:"validation",type:"integer",reference:De,async:!1,expects:null,requirement:Number.isInteger,message:t,"~run"(e,n){return e.typed&&!this.requirement(e.value)&&g(this,"integer",e,n),e}}}function S(t){return{kind:"transformation",type:"transform",reference:S,async:!1,operation:t,"~run"(e){return e.value=this.operation(e.value),e}}}function Oe(t,e,n){return typeof t.default=="function"?t.default(e,n):t.default}function Ht(t,e){return!t["~run"]({value:e},{abortEarly:!0}).issues}function W(t){return{kind:"schema",type:"boolean",reference:W,expects:"boolean",async:!1,message:t,get"~standard"(){return v(this)},"~run"(e,n){return typeof e.value=="boolean"?e.typed=!0:g(this,"type",e,n),e}}}function Ce(t){return{kind:"schema",type:"date",reference:Ce,expects:"Date",async:!1,message:t,get"~standard"(){return v(this)},"~run"(e,n){return e.value instanceof Date?isNaN(e.value)?g(this,"type",e,n,{received:'"Invalid Date"'}):e.typed=!0:g(this,"type",e,n),e}}}function Ne(t,e){return{kind:"schema",type:"instance",reference:Ne,expects:t.name,async:!1,class:t,message:e,get"~standard"(){return v(this)},"~run"(n,r){return n.value instanceof this.class?n.typed=!0:g(this,"type",n,r),n}}}function ne(t){return{kind:"schema",type:"lazy",reference:ne,expects:"unknown",async:!1,getter:t,get"~standard"(){return v(this)},"~run"(e,n){return this.getter(e.value)["~run"](e,n)}}}function q(t,e){return{kind:"schema",type:"loose_object",reference:q,expects:"Object",async:!1,entries:t,message:e,get"~standard"(){return v(this)},"~run"(n,r){var s;const i=n.value;if(i&&typeof i=="object"){n.typed=!0,n.value={};for(const a in this.entries){const u=this.entries[a];if(a in i||(u.type==="exact_optional"||u.type==="optional"||u.type==="nullish")&&u.default!==void 0){const o=a in i?i[a]:Oe(u),c=u["~run"]({value:o},r);if(c.issues){const l={type:"object",origin:"value",input:i,key:a,value:o};for(const f of c.issues)f.path?f.path.unshift(l):f.path=[l],(s=n.issues)==null||s.push(f);if(n.issues||(n.issues=c.issues),r.abortEarly){n.typed=!1;break}}c.typed||(n.typed=!1),n.value[a]=c.value}else if(u.type!=="exact_optional"&&u.type!=="optional"&&u.type!=="nullish"&&(g(this,"key",n,r,{input:void 0,expected:`"${a}"`,path:[{type:"object",origin:"key",input:i,key:a,value:i[a]}]}),r.abortEarly))break}if(!n.issues||!r.abortEarly)for(const a in i)Ue(i,a)&&!(a in this.entries)&&(n.value[a]=i[a])}else g(this,"type",n,r);return n}}}function O(t){return{kind:"schema",type:"number",reference:O,expects:"number",async:!1,message:t,get"~standard"(){return v(this)},"~run"(e,n){return typeof e.value=="number"&&!isNaN(e.value)?e.typed=!0:g(this,"type",e,n),e}}}function b(t,e){return{kind:"schema",type:"optional",reference:b,expects:`(${t.expects} | undefined)`,async:!1,wrapped:t,default:e,get"~standard"(){return v(this)},"~run"(n,r){return n.value===void 0&&(this.default!==void 0&&(n.value=Oe(this,n,r)),n.value===void 0)?(n.typed=!0,n):this.wrapped["~run"](n,r)}}}function Je(t,e,n){return{kind:"schema",type:"record",reference:Je,expects:"Object",async:!1,key:t,value:e,message:n,get"~standard"(){return v(this)},"~run"(r,s){var i,a;const u=r.value;if(u&&typeof u=="object"){r.typed=!0,r.value={};for(const o in u)if(Ue(u,o)){const c=u[o],l=this.key["~run"]({value:o},s);if(l.issues){const h={type:"object",origin:"key",input:u,key:o,value:c};for(const _ of l.issues)_.path=[h],(i=r.issues)==null||i.push(_);if(r.issues||(r.issues=l.issues),s.abortEarly){r.typed=!1;break}}const f=this.value["~run"]({value:c},s);if(f.issues){const h={type:"object",origin:"value",input:u,key:o,value:c};for(const _ of f.issues)_.path?_.path.unshift(h):_.path=[h],(a=r.issues)==null||a.push(_);if(r.issues||(r.issues=f.issues),s.abortEarly){r.typed=!1;break}}(!l.typed||!f.typed)&&(r.typed=!1),l.typed&&(r.value[l.value]=f.value)}}else g(this,"type",r,s);return r}}}function d(t){return{kind:"schema",type:"string",reference:d,expects:"string",async:!1,message:t,get"~standard"(){return v(this)},"~run"(e,n){return typeof e.value=="string"?e.typed=!0:g(this,"type",e,n),e}}}function ze(t){let e;if(t)for(const n of t)e?e.push(...n.issues):e=n.issues;return e}function re(t,e){return{kind:"schema",type:"union",reference:re,expects:Kt(t.map(n=>n.expects),"|"),async:!1,options:t,message:e,get"~standard"(){return v(this)},"~run"(n,r){let s,i,a;for(const u of this.options){const o=u["~run"]({value:n.value},r);if(o.typed)if(o.issues)i?i.push(o):i=[o];else{s=o;break}else a?a.push(o):a=[o]}if(s)return s;if(i){if(i.length===1)return i[0];g(this,"type",n,r,{issues:ze(i)}),n.typed=!0}else{if((a==null?void 0:a.length)===1)return a[0];g(this,"type",n,r,{issues:ze(a)})}return n}}}function Ge(){return{kind:"schema",type:"unknown",reference:Ge,expects:"unknown",async:!1,get"~standard"(){return v(this)},"~run"(t){return t.typed=!0,t}}}function Fe(t,e,n){const r=t["~run"]({value:e},xe(n));if(r.issues)throw new Yt(r.issues);return r.value}function j(...t){return{...t[0],pipe:t,get"~standard"(){return v(this)},"~run"(e,n){for(const r of t)if(r.kind!=="metadata"){if(e.issues&&(r.kind==="schema"||r.kind==="transformation")){e.typed=!1;break}(!e.issues||!n.abortEarly&&!n.abortPipeEarly)&&(e=r["~run"](e,n))}return e}}}function Qt(t){return t.replace(/_[a-z]/g,e=>e[1].toUpperCase())}function Zt(t){return Object.entries(t).reduce((e,[n,r])=>(e[Qt(n)]=r,e),{})}function se(t){const e=Zt(t);for(const n in e){const r=e[n];r&&typeof r=="object"&&!(r instanceof Date)&&(e[n]=Array.isArray(r)?r.map(se):se(r))}return e}function ae(t){return S(e=>t?se(e):e)}function Be(t){return e=>j(t,ae(e))}function Xt(t){return(e,n)=>Fe(j(t,ae(n)),e)}function ie(){return S(JSON.parse)}function oe(t){const e=Be(t);return n=>j(d(),ie(),e(n))}function Vt(t){return S(e=>{const n={};return new URLSearchParams(e).forEach((r,s)=>{const i=n[s];Array.isArray(i)?i.push(r):i===void 0?n[s]=r:n[s]=[i,r]}),Fe(t,n)})}function Ke(t){return e=>j(re([d(),Ne(URLSearchParams)]),Vt(t),ae(e))}const Ye=b(ne(()=>sn())),en=q({id:O(),photo_url:b(d()),type:d(),title:d(),username:b(d())}),tn=q({added_to_attachment_menu:b(W()),allows_write_to_pm:b(W()),first_name:d(),id:O(),is_bot:b(W()),is_premium:b(W()),last_name:b(d()),language_code:b(d()),photo_url:b(d()),username:b(d())}),nn=q({auth_date:j(d(),S(t=>new Date(Number(t)*1e3)),Ce()),can_send_after:b(j(d(),S(Number),De())),chat:b(ne(()=>rn())),chat_type:b(d()),chat_instance:b(d()),hash:d(),query_id:b(d()),receiver:Ye,start_param:b(d()),signature:d(),user:Ye}),rn=oe(en),sn=oe(tn),an=Ke(nn);function on(t){return/^#[\da-f]{6}$/i.test(t)}const He=Be(Je(d(),j(re([d(),O()]),S(t=>typeof t=="number"?`#${(t&16777215).toString(16).padStart(6,"0")}`:t),We(on)))),ue=b(j(d(),S(t=>t==="1"))),Qe=oe(He()),un=q({tgWebAppBotInline:ue,tgWebAppData:b(an()),tgWebAppDefaultColors:b(Qe()),tgWebAppFullscreen:ue,tgWebAppPlatform:d(),tgWebAppShowSettings:ue,tgWebAppStartParam:b(d()),tgWebAppThemeParams:Qe(),tgWebAppVersion:d()}),Ze=Ke(un),ce=Xt(Ze()),Xe=q({eventType:d(),eventData:b(Ge())});function Ve(t,e){return e||(e=(n,r)=>JSON.stringify(r)),new URLSearchParams(Object.entries(t).reduce((n,[r,s])=>(Array.isArray(s)?n.push(...s.map(i=>[r,String(i)])):s!=null&&n.push([r,s instanceof Date?(s.getTime()/1e3|0).toString():typeof s=="string"||typeof s=="number"?String(s):typeof s=="boolean"?s?"1":"0":e(r,s)]),n),[])).toString()}function cn(t){return Ve(t)}function ln(t){return Ve(t,(e,n)=>e==="tgWebAppData"?cn(n):JSON.stringify(n))}function et(t){try{return Ht(Ze(),t)}catch{return!1}}function pn(t){return{all:t=t||new Map,on:function(e,n){var r=t.get(e);r?r.push(n):t.set(e,[n])},off:function(e,n){var r=t.get(e);r&&(n?r.splice(r.indexOf(n)>>>0,1):t.set(e,[]))},emit:function(e,n){var r=t.get(e);r&&r.slice().map(function(s){s(n)}),(r=t.get("*"))&&r.slice().map(function(s){s(e,n)})}}}function fn(t,e){const n=pn(),r=new Map,s=(i,a,u)=>{u||(u=!1);const o=r.get(i)||new Map;r.set(i,o);const c=o.get(a)||[];o.set(a,c);const l=c.findIndex(f=>f[1]===u);l>=0&&(n.off(i,c[l][0]),c.splice(l,1),!c.length&&o.delete(a),o.size||(r.delete(i),!r.size&&e()))};return[function(a,u,o){!r.size&&t();function c(){s(a,u,o)}function l(..._){o&&c(),a==="*"?u(_):u(..._)}n.on(a,l);const f=r.get(a)||new Map;r.set(a,f);const h=f.get(u)||[];return f.set(u,h),h.push([l,o||!1]),c},s,n.emit,function(){const a=n.all.size;n.all.clear(),r.clear(),a&&e()}]}function le(t,e){window.dispatchEvent(new MessageEvent("message",{data:JSON.stringify({eventType:t,eventData:e}),source:window.parent}))}function dn(t,e){e()}function pe(t,e){e||(e={});const n=e.equals||Object.is;let r=[],s=t;const i=c=>{if(!n(s,c)){const l=s;s=c,dn(o,()=>{[...r].forEach(([f,h])=>{f(c,l),h&&u(f,!0)})})}};function a(c){const l=typeof c!="object"?{once:c}:c;return{once:l.once||!1,signal:l.signal||!1}}const u=(c,l)=>{const f=a(l),h=r.findIndex(([_,A])=>_===c&&A.once===f.once&&A.signal===f.signal);h>=0&&r.splice(h,1)},o=Object.assign(function(){return yn(o),s},{destroy(){r=[]},set:i,reset(){i(t)},sub(c,l){return r.push([c,a(l)]),()=>u(c,l)},unsub:u,unsubAll(){r=r.filter(c=>c[1].signal)}});return o}const fe=[];function yn(t){fe.length&&fe[fe.length-1].add(t)}let C=!1;const tt=t=>{$().log("Event received:",t)};function nt(t){t!==C&&(C=t,C?de("*",tt):st("*",tt))}const $=pe(Re("Bridge",{bgColor:"#9147ff",textColor:"white",shouldLog(){return C}})),bn={clipboard_text_received:w({req_id:P(),data:U(P())}),custom_method_invoked:w({req_id:P(),result:Q(ke()),error:Q(P())}),popup_closed:U(w({button_id:U(P(),()=>{})}),{}),viewport_changed:w({height:H(),width:U(H(),()=>window.innerWidth),is_state_stable:K(),is_expanded:K()}),theme_changed:w({theme_params:He()})};function rt(t){if(t.source!==window.parent)return;let e;try{e=Z($e(P(),ie(),Xe),t.data)}catch{return}const{eventType:n,eventData:r}=e,s=bn[n];let i;try{i=s?Z(s,r):r}catch(a){return $().forceError([`An error occurred processing the "${n}" event from the Telegram application.`,"Please, file an issue here:","https://github.com/Telegram-Mini-Apps/telegram-apps/issues/new/choose"].join(`
`),e,a)}hn(n,i)}const[de,st,hn,at]=fn(()=>{const t=window,e={receiveEvent:le};t.TelegramGameProxy_receiveEvent=le,t.TelegramGameProxy=e,t.Telegram={WebView:e},window.addEventListener("message",rt)},()=>{["TelegramGameProxy_receiveEvent","TelegramGameProxy","Telegram"].forEach(t=>{delete window[t]}),window.removeEventListener("message",rt)});var _n=Object.defineProperty,mn=(t,e,n)=>e in t?_n(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ye=(t,e,n)=>mn(t,typeof e!="symbol"?e+"":e,n);function it(t,e){return n=>n instanceof t&&n.type===e}function I(t,e){e||(e=[]);const n=Symbol(t);class r extends Error{constructor(...i){const a=typeof e=="function"?e(...i):typeof e=="string"?[e]:e||[];super(...a),ye(this,"type",n),this.name=t}}return Object.defineProperty(r,"name",{value:t}),[r,it(r,n)]}function gn(t,e,n){const r=Symbol(t);class s extends I(t,n)[0]{constructor(...a){super(...a),ye(this,"data"),ye(this,"type",r),this.data=e(...a)}}return Object.defineProperty(s,"name",{value:t}),[s,it(s,r)]}const[ot,vn]=I("MethodUnsupportedError",(t,e)=>[`Method "${t}" is unsupported in Mini Apps version ${e}`]),[ut,wn]=I("MethodParameterUnsupportedError",(t,e,n)=>[`Parameter "${e}" of "${t}" method is unsupported in Mini Apps version ${n}`]),[ct,En]=gn("LaunchParamsRetrieveError",t=>({errors:t}),t=>[["Unable to retrieve launch parameters from any known source. Perhaps, you have opened your app outside Telegram?","📖 Refer to docs for more information:","https://docs.telegram-mini-apps.com/packages/telegram-apps-bridge/environment","","Collected errors:",...t.map(([e,n])=>`Source: ${e} / ${n instanceof Error?n.message:String(n)}`)].join(`
`)]),[lt,kn]=I("InvalidLaunchParamsError",(t,e)=>[`Invalid value for launch params: ${t}`,{cause:e}]),[pt,$n]=I("UnknownEnvError"),[ft,Pn]=I("InvokeCustomMethodError",t=>[`Server returned error: ${t}`]),L=pe((...t)=>{try{window.parent.postMessage(...t)}catch(e){e instanceof SyntaxError?$().forceError("Unable to call window.parent.postMessage due to incorrectly configured target origin. Use the setTargetOrigin method to allow this origin to receive events",e):$().forceError(e)}}),dt=(...t)=>L()(...t),N=pe("https://web.telegram.org");function Sn(t){N.set(t),$().log("New target origin set",t)}function be(t,e){$().log("Posting event:",e?{eventType:t,eventData:e}:{eventType:t});const n=window,r=JSON.stringify({eventType:t,eventData:e});if(V())return dt(r,N());if(X(n)){n.TelegramWebviewProxy.postEvent(t,JSON.stringify(e));return}if(D(w({external:w({notify:Y()})}),n)){n.external.notify(r);return}throw new pt}function he(t,e,n){n||(n={});const{capture:r}=n,[s,i]=Gt();return new M(a=>{(Array.isArray(e)?e:[e]).forEach(u=>{s(de(u,o=>{(!r||(Array.isArray(e)?r({event:u,payload:o}):r(o)))&&a(o)}))}),(n.postEvent||be)(t,n.params)},n).finally(i)}const yt="launchParams";function bt(t){return t.replace(/^[^?#]*[?#]/,"").replace(/[?#]/g,"&")}function _e(){const t=[];for(const[e,n]of[[()=>bt(window.location.href),"window.location.href"],[()=>{const r=performance.getEntriesByType("navigation")[0];return r&&bt(r.name)},"performance navigation entries"],[()=>zt(yt),"local storage"]]){const r=e();if(!r){t.push([n,new Error("Source is empty")]);continue}if(et(r))return Le(yt,r),r;try{ce(r)}catch(s){t.push([n,s])}}throw new ct(t)}function ht(t){const e=ce(_e());return t?te(e):e}function jn(t,e){if(!t)try{return ht(),!0}catch{return!1}return M.fn(async n=>{if(X(window))return!0;try{return await he("web_app_request_theme","theme_changed",n),!0}catch{return!1}},e||{timeout:100})}function An({launchParams:t,onEvent:e,resetPostMessage:n}={}){if(t){const i=typeof t=="string"||t instanceof URLSearchParams?t.toString():ln({...t,tgWebAppData:void 0})+(t.tgWebAppData?`&tgWebAppData=${encodeURIComponent(t.tgWebAppData.toString())}`:"");if(!et(i))try{ce(i)}catch(a){throw new lt(i,a)}Le("launchParams",i)}if(V()){if(!e)return;const i=$e(P(),ie(),Xe);n&&L.reset();const a=L();L.set((...u)=>{const[o]=u,c=()=>{a(...u)};if(D(i,o)){const l=Z(i,o);e([l.eventType,l.eventData],c)}else c()});return}const r=window.TelegramWebviewProxy||{},s=r.postEvent||(()=>{});window.TelegramWebviewProxy={...r,postEvent(i,a){const u=()=>{s(i,a)};e?e([i,a?JSON.parse(a):void 0],u):u()}},$().log("Environment was mocked by the mockTelegramEnv function")}function Mn(){return new URLSearchParams(_e()).get("tgWebAppData")||void 0}function _t(t){return({req_id:e})=>e===t}function mt(t){return t.split(".").map(Number)}function gt(t,e){const n=mt(t),r=mt(e),s=Math.max(n.length,r.length);for(let i=0;i<s;i+=1){const a=n[i]||0,u=r[i]||0;if(a!==u)return a>u?1:-1}return 0}function m(t,e){return gt(t,e)<=0}function me(t,e,n){if(typeof n=="string"){if(t==="web_app_open_link"){if(e==="try_instant_view")return m("6.4",n);if(e==="try_browser")return m("7.6",n)}if(t==="web_app_set_header_color"&&e==="color")return m("6.9",n);if(t==="web_app_close"&&e==="return_back")return m("7.6",n);if(t==="web_app_setup_main_button"&&e==="has_shine_effect")return m("7.10",n)}switch(t){case"web_app_open_tg_link":case"web_app_open_invoice":case"web_app_setup_back_button":case"web_app_set_background_color":case"web_app_set_header_color":case"web_app_trigger_haptic_feedback":return m("6.1",e);case"web_app_open_popup":return m("6.2",e);case"web_app_close_scan_qr_popup":case"web_app_open_scan_qr_popup":case"web_app_read_text_from_clipboard":return m("6.4",e);case"web_app_switch_inline_query":return m("6.7",e);case"web_app_invoke_custom_method":case"web_app_request_write_access":case"web_app_request_phone":return m("6.9",e);case"web_app_setup_settings_button":return m("6.10",e);case"web_app_biometry_get_info":case"web_app_biometry_open_settings":case"web_app_biometry_request_access":case"web_app_biometry_request_auth":case"web_app_biometry_update_token":return m("7.2",e);case"web_app_setup_swipe_behavior":return m("7.7",e);case"web_app_share_to_story":return m("7.8",e);case"web_app_setup_secondary_button":case"web_app_set_bottom_bar_color":return m("7.10",e);case"web_app_request_safe_area":case"web_app_request_content_safe_area":case"web_app_request_fullscreen":case"web_app_exit_fullscreen":case"web_app_set_emoji_status":case"web_app_add_to_home_screen":case"web_app_check_home_screen":case"web_app_request_emoji_status_access":case"web_app_check_location":case"web_app_open_location_settings":case"web_app_request_file_download":case"web_app_request_location":case"web_app_send_prepared_message":case"web_app_start_accelerometer":case"web_app_start_device_orientation":case"web_app_start_gyroscope":case"web_app_stop_accelerometer":case"web_app_stop_device_orientation":case"web_app_stop_gyroscope":case"web_app_toggle_orientation_lock":return m("8.0",e);default:return["iframe_ready","iframe_will_reload","web_app_close","web_app_data_send","web_app_expand","web_app_open_link","web_app_ready","web_app_request_theme","web_app_request_viewport","web_app_setup_main_button","web_app_setup_closing_behavior"].includes(t)}}function Tn(t,e){e||(e="strict");const n=typeof e=="function"?e:r=>{const{method:s,version:i}=r,a="param"in r?new ut(s,r.param,i):new ot(s,i);if(e==="strict")throw a;return $().forceWarn(a.message)};return(r,s)=>me(r,t)?r==="web_app_set_header_color"&&D(w({color:Ee()}),s)&&!me(r,"color",t)?n({version:t,method:r,param:"color"}):be(r,s):n({version:t,method:r})}function qn(t,e,n,r){return he("web_app_invoke_custom_method","custom_method_invoked",{...r||{},params:{method:t,params:e,req_id:n},capture:_t(n)}).then(({result:s,error:i})=>{if(i)throw new ft(i);return s})}function In(){at(),nt(!1),[L,N].forEach(t=>{t.unsubAll(),t.reset()})}return p.AbortablePromise=M,p.CancelledError=Se,p.InvalidLaunchParamsError=lt,p.InvokeCustomMethodError=ft,p.LaunchParamsRetrieveError=ct,p.ManualPromise=Ct,p.MethodParameterUnsupportedError=ut,p.MethodUnsupportedError=ot,p.TimeoutError=je,p.UnknownEnvError=pt,p.captureSameReq=_t,p.compareVersions=gt,p.createLogger=Re,p.createPostEvent=Tn,p.emitEvent=le,p.hasWebviewProxy=X,p.invokeCustomMethod=qn,p.isCancelledError=Wt,p.isIframe=V,p.isInvalidLaunchParamsError=kn,p.isInvokeCustomMethodError=Pn,p.isLaunchParamsRetrieveError=En,p.isMethodMethodParameterUnsupportedError=wn,p.isMethodUnsupportedError=vn,p.isTMA=jn,p.isTimeoutError=Dt,p.isUnknownEnvError=$n,p.logger=$,p.mockTelegramEnv=An,p.off=st,p.offAll=at,p.on=de,p.postEvent=be,p.postMessage=dt,p.postMessageImplementation=L,p.request=he,p.resetPackageState=In,p.retrieveLaunchParams=ht,p.retrieveRawInitData=Mn,p.retrieveRawLaunchParams=_e,p.setDebug=nt,p.setTargetOrigin=Sn,p.supports=me,p.targetOrigin=N,Object.defineProperty(p,Symbol.toStringTag,{value:"Module"}),p}({});
//# sourceMappingURL=index.iife.js.map
